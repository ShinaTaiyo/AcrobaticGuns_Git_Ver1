//============================================================================================================================================
//
//１０月３０日：敵を作る[enemy.cpp]
//Author:ShinaTaiyo
//
//============================================================================================================================================

//====================================================================================
//インクルード
//====================================================================================
#include "enemy.h"
#include "manager.h"
#include "objectXInfo.h"
//============================================================================================================================================

//====================================================================================
//静的メンバ宣言
//====================================================================================
const string CEnemy::m_aENEMY_FILENAME[int(ENEMYTYPE::MAX)] =
{
	"data\\MODEL\\Enemy\\Normal\\noobSlime.x"
};

//====================================================================================
//コンストラクタ
//====================================================================================
CEnemy::CEnemy(int nPri, bool bUseintPri, CObject::TYPE type, CObject::OBJECTTYPE ObjType) : CObjectXAlive(nPri,bUseintPri,type,ObjType),
m_Type(ENEMYTYPE::NORMAL)
{

}
//============================================================================================================================================

//====================================================================================
//デストラクタ
//====================================================================================
CEnemy::~CEnemy()
{

}
//============================================================================================================================================

//====================================================================================
//初期化処理
//====================================================================================
HRESULT CEnemy::Init()
{
	CObjectXAlive::Init();
	return S_OK;
}
//============================================================================================================================================

//====================================================================================
//終了処理
//====================================================================================
void CEnemy::Uninit()
{
	CObjectXAlive::Uninit();
}
//============================================================================================================================================

//====================================================================================
//更新処理
//====================================================================================
void CEnemy::Update()
{
	CObjectXAlive::Update();
}
//============================================================================================================================================

//====================================================================================
//描画処理
//====================================================================================
void CEnemy::Draw()
{
	CObjectXAlive::Draw();
}
//============================================================================================================================================

//====================================================================================
//死亡フラグ設定処理
//====================================================================================
void CEnemy::SetDeath()
{
	CObjectXAlive::SetDeath();
}
//============================================================================================================================================

//====================================================================================
//生成処理
//====================================================================================
CEnemy* CEnemy::Create(ENEMYTYPE Type, int nLife, D3DXVECTOR3 pos, D3DXVECTOR3 rot, D3DXVECTOR3 Scale)
{
	CEnemy* pEnemy = DBG_NEW CEnemy;

	pEnemy->Init();            //初期化処理
	int nIdx = CManager::GetObjectXInfo()->Regist(m_aENEMY_FILENAME[int(Type)]);
	pEnemy->BindObjectXInfo(CManager::GetObjectXInfo()->GetMesh(nIdx),
		CManager::GetObjectXInfo()->GetBuffMat(nIdx),
		CManager::GetObjectXInfo()->GetdwNumMat(nIdx),
		CManager::GetObjectXInfo()->GetTexture(nIdx),
		CManager::GetObjectXInfo()->GetColorValue(nIdx));

	pEnemy->SetType(CObject::TYPE::ENEMY);//オブジェクトタイプを設定
	pEnemy->SetEnemyType(Type);//敵の種類を設定
	pEnemy->SetLife(nLife);    //体力
	pEnemy->SetMaxLife(nLife); //最大体力
	pEnemy->SetPos(pos);       //位置
	pEnemy->SetSupportPos(pos);//支点位置
	pEnemy->SetRot(rot);       //向き
	pEnemy->SetScale(Scale);   //拡大率
	pEnemy->SetFormarScale(Scale);//元の拡大率を設定

	pEnemy->SetSize();//モデルサイズを設定
	pEnemy->SetAutoSubLife(false);//自動的に体力を減らすかどうか

	return pEnemy;
}
//============================================================================================================================================